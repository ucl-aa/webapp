@page "/"
@using WebApp.Services
@using WebApp.ViewModels
<PageTitle>Index</PageTitle>

<div>
	<img src=~/logoicon.png/>
	<div class='background'>
			<h1 class='title'>Tracking Number</h1>
			<input placeholder='xxxx-xxxx-xxxx' @bind="tracingId"class='traceinput'/>
			<button @onclick="OnTrackingIdButtonClick">Enter</button>
	</div>
	<div>
		<label>History</label>
		<table border="1">
		<tbody>
		@foreach(var status in _statusHistory)
		{
			<tr>
				<td>
					@status.UpdateTime: 
				</td>
				<td>
					@status.Message
				</td>
			</tr>
		}
		</tbody>
		</table>
	</div>
</div>

@code 
{
	private string tracingId = "";
	private IDeliveryService _deliveryService= new DeliveryServiceStub();
	private List<Delivery> _deliveries = new List<Delivery>();
	private List<Status> _statusHistory = new List<Status>();

	private async void OnTrackingIdButtonClick()
	{
		_deliveries.Add(await _deliveryService.GetDeliveryAsync(tracingId));
		_statusHistory.AddRange(_deliveries[0].StatusHistory);
	}

}